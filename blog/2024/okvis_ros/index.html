<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>OKVIS_ROS installation error mix | Yuhang Ming</title> <meta name="author" content="Yuhang Ming"> <meta name="description" content="debugging notes."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/icon.png"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://yuhangming.github.io/blog/2024/okvis_ros/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Yuhang </span>Ming</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">OKVIS_ROS installation error mix</h1> <p class="post-meta">June 1, 2024</p> <p class="post-tags"> <a href="/blog/2024"> <i class="fas fa-calendar fa-sm"></i> 2024 </a>   ·   <a href="/blog/tag/env-setup"> <i class="fas fa-hashtag fa-sm"></i> env-setup</a>     ·   <a href="/blog/category/mix-posts"> <i class="fas fa-tag fa-sm"></i> mix-posts</a>   </p> </header> <article class="post-content"> <h1 id="table-of-content">Table of Content</h1> <ul> <li><a href="#table-of-content">Table of Content</a></li> <li><a href="#system-info">System Info</a></li> <li> <a href="#ros">ROS</a> <ul> <li><a href="#py_em">PY_em</a></li> <li><a href="#rospkg">rospkg</a></li> <li><a href="#gazebo">gazebo</a></li> </ul> </li> <li> <a href="#make-okvis">Make OKVIS</a> <ul> <li><a href="#bullet">Bullet</a></li> <li><a href="#ogre">OGRE</a></li> <li><a href="#image_geometry-and-others">image_geometry and others</a></li> <li><a href="#ceres-solver">ceres-solver</a></li> <li> <a href="#eigen">Eigen</a> <ul> <li><a href="#roseigen">ros+eigen</a></li> </ul> </li> <li><a href="#pcl">pcl</a></li> <li><a href="#dataset_convertorcpp">dataset_convertor.cpp</a></li> <li> <a href="#opencv">OpenCV</a> <ul> <li><a href="#libgtk-error">libgtk error</a></li> </ul> </li> <li><a href="#gtstream">gtstream</a></li> </ul> </li> </ul> <h1 id="system-info">System Info</h1> <p>Ubuntu20.04, ROS Noetic, cuda11.1.</p> <h1 id="ros">ROS</h1> <h2 id="py_em">PY_em</h2> <blockquote> <p>– Could NOT find PY_em (missing: PY_EM)</p> </blockquote> <p><em>Full Error message:</em></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-- Could NOT find PY_em (missing: PY_EM)
CMake Error at /opt/ros/melodic/share/catkin/cmake/empy.cmake:29 (message):
  Unable to find either executable 'empy' or Python module 'em'...  try
  installing the package 'python-empy'
Call Stack (most recent call first):
  /opt/ros/melodic/share/catkin/cmake/all.cmake:163 (include)
  /opt/ros/melodic/share/catkin/cmake/catkinConfig.cmake:20 (include)
  CMakeLists.txt:56 (find_package)
</code></pre></div></div> <p><em>Analysis:</em> catkin finds the python in anaconda, we need to point catkin to the system python.</p> <p><em>Solution:</em></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>catkin_make -DPYTHON_EXECUTABLE=/usr/bin/python3
</code></pre></div></div> <p><a href="https://github.com/ros-melodic-arch/ros-melodic-catkin/issues/2" rel="external nofollow noopener" target="_blank">ref_link</a></p> <h2 id="rospkg">rospkg</h2> <blockquote> <p>ModuleNotFoundError :No module named ‘rospkg’</p> </blockquote> <p><em>Analysis:</em> Happens when running <code class="language-plaintext highlighter-rouge">roscreate-pkg</code>. This could because you are running the file with the wrong python interpreter.</p> <p><em>Solutions:</em></p> <ol> <li>change teh shebang in the python files. For noetic or later, use <code class="language-plaintext highlighter-rouge">#!/usr/bin/env python3</code>; for melodic or earlier, use <code class="language-plaintext highlighter-rouge">#!/usr/bin/env python2</code>.</li> <li>run <code class="language-plaintext highlighter-rouge">pip install rospkg</code>.</li> </ol> <h2 id="gazebo">gazebo</h2> <blockquote> <p>Can’t open /usr/share/gazebo//setup.sh</p> </blockquote> <p><em>Analysis:</em> The problem is in the scripts located in <code class="language-plaintext highlighter-rouge">/opt/ros/indigo/lib/gazebo_ros</code>. There are several scripts (i.e. gzclient, gzserver, etc.) which are executed when you perform a <code class="language-plaintext highlighter-rouge">rosrun</code> command. When trying to run gazebo, ROS needs to source the gazebo <code class="language-plaintext highlighter-rouge">setup.sh</code> script to make sure that the proper gazebo paths are defined. This is the line in the ROS scripts which has a problem: <code class="language-plaintext highlighter-rouge">setup_path=$(pkg-config --variable=prefix gazebo)/share/gazebo/</code> The problem is that <code class="language-plaintext highlighter-rouge">pkg-config</code> should find the path to gazebo, but it doesn’t seem to work. Since it doesn’t find gazebo, the script just continues execution using “/share/gazebo/” as the path. Also, it looks like there is an extra slash at the end.</p> <p><em>Solution:</em> A simple workaround: change <code class="language-plaintext highlighter-rouge">setup_path=/usr/share/gazebo</code> in <code class="language-plaintext highlighter-rouge">gzclient</code> and <code class="language-plaintext highlighter-rouge">gzserver</code>.</p> <p><a href="https://answers.ros.org/question/215796/problem-for-install-gazebo_ros_package/" rel="external nofollow noopener" target="_blank">ref_link</a>, <a href="https://answers.gazebosim.org//question/8577/gazebo-22-cant-open-usrsharegazebosetupsh/" rel="external nofollow noopener" target="_blank">ref_link2</a></p> <h1 id="make-okvis">Make OKVIS</h1> <h2 id="bullet">Bullet</h2> <blockquote> <p>No package ‘bullet’ found.</p> </blockquote> <p><em>Full error message:</em></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-- Checking for module 'bullet&gt;=2.82'
-- No package 'bullet' found
-- Checking for module 'bullet2.82&gt;=2.82'
-- No package 'bullet2.82' found
CMake Error at /usr/lib/x86_64-linux-gnu/cmake/gazebo/gazebo-config.cmake:102 (message):
Error: Bullet &gt; 2.82 not found, please install libbullet2.82-dev.
Call Stack (most recent call first):
CMakeLists.txt:11 (find_package)
</code></pre></div></div> <p><em>Solution:</em></p> <ol> <li>find <code class="language-plaintext highlighter-rouge">bullet.pc</code> with <code class="language-plaintext highlighter-rouge">sudo find / -name "bullet.pc"</code>;</li> <li>Add the directory to <code class="language-plaintext highlighter-rouge">PKG_CONFIG_PATH</code> with <code class="language-plaintext highlighter-rouge">export PKG_CONFIG_PATH=$PKF_CONFIG_PATH:&lt;folder_containing_bullet.pc&gt;</code>.</li> </ol> <p><a href="https://github.com/khancyr/ardupilot_gazebo/issues/14" rel="external nofollow noopener" target="_blank">ref_link</a></p> <h2 id="ogre">OGRE</h2> <blockquote> <p>Could not find a configuration file for package ogre.</p> </blockquote> <p><em>Full Error Message:</em></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CMake Error at CMakeLists.txt:46 (find_package):
By not providing "FindOGRE.cmake" in CMAKE_MODULE_PATH this project has
asked CMake to find a package configuration file provided by "OGRE", but
CMake did not find one.

Could not find a package configuration file provided by "OGRE" with any of
the following names:

OGREConfig.cmake
ogre-config.cmake

Add the installation prefix of "OGRE" to CMAKE_PREFIX_PATH or set
"OGRE_DIR" to a directory containing one of the above files.  If "OGRE"
provides a separate development package or SDK, be sure it has been
installed.


-- Configuring incomplete, errors occurred!
</code></pre></div></div> <p><em>Analysis:</em> CMake failed to look at the right path.</p> <p><em>Solution:</em> add <code class="language-plaintext highlighter-rouge">set(CMAKE_MODULE_PATH "/usr/share/OGRE/cmake/modules/;${CMAKE_MODULE_PATH}")</code> to the CMakeLists.txt</p> <p><a href="https://stackoverflow.com/questions/15982661/error-with-ogre-and-cmake" rel="external nofollow noopener" target="_blank">ref-link</a>, <a href="https://cmake.org/cmake/help/v3.16/command/find_path.html" rel="external nofollow noopener" target="_blank">cmake-find_path()</a>.</p> <h2 id="image_geometry-and-others">image_geometry and others</h2> <blockquote> <p>Could not find a configuration file for package image_geometry.</p> </blockquote> <p><em>Full Error Message:</em></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CMake Error at /opt/ros/hydro/share/catkin/cmake/catkinConfig.cmake:75 (find_package):
  Could not find a configuration file for package image_geometry.

  Set image_geometry_DIR to the directory containing a CMake configuration
  file for image_geometry.  The file will have one of the following names:

    image_geometryConfig.cmake
    image_geometry-config.cmake

Call Stack (most recent call first):
  viso2-hydro/viso2_ros/CMakeLists.txt:4 (find_package)
</code></pre></div></div> <p><em>Analysis:</em> packages not installed.</p> <p><em>Solution:</em> run <code class="language-plaintext highlighter-rouge">sudo apt install ros-noetic-image-geometry</code></p> <h2 id="ceres-solver">ceres-solver</h2> <blockquote> <p>cc1plus: some warnings are being treated as errors</p> </blockquote> <p><em>Full Error Message:</em></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>xxxxxx/ceres/schur_eliminator.h:267:10:
    struct Chunk {
           ^~~~~
cc1plus: some warnings are being treated as errors
internal/ceres/CMakeFiles/ceres.dir/build.make:2558: recipe for target 'internal/ceres/CMakeFiles/ceres.dir/generated/schur_eliminator_2_2_2.cc.o' failed
</code></pre></div></div> <p><em>Analysis:</em> Problem tag when downloading ceres1.9.0</p> <p><em>Solution:</em> change the tag from <code class="language-plaintext highlighter-rouge">7c57de5080c9f5a4f067e2d20b5f33bad5b1ade6</code> to <code class="language-plaintext highlighter-rouge">451e71c6b7c127ebfd29f0eb658543d512629a4e</code>. Then, <code class="language-plaintext highlighter-rouge">cd</code> to <code class="language-plaintext highlighter-rouge">/catkin_ws/build/okvis_ros/okvis/ceres/src/ceres-external</code>, modify CMakeLists.txt:ln 643, delete the <code class="language-plaintext highlighter-rouge">-Werror</code> flag.</p> <h2 id="eigen">Eigen</h2> <blockquote> <p>fatal error: Eigen/Dense: no such file or directory</p> </blockquote> <p><em>Analysis:</em> Eigen is installed in the folder named <code class="language-plaintext highlighter-rouge">eigen3</code>, not <code class="language-plaintext highlighter-rouge">Eigen</code>, creating soft links solves the problem.</p> <p><em>Solution:</em>: do the following command</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd /usr/local/incllude
sudo ln -sf eigen3/Eigen Eigen
sudo ln -sf eigen3/unsupported unsupported
</code></pre></div></div> <h3 id="roseigen">ros+eigen</h3> <blockquote> <p>CMake Error at xxx.</p> </blockquote> <p><em>Full Error Message:</em></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CMake Error at /opt/ros/melodic/share/pcl_ros/cmake/pcl_rosConfig.cmake:113(message):
project 'pcl_ros' specifies '/usr/include/eigen3' as an include dir,which is not found. 
it does neither exist as an absolute directory nor in……'
</code></pre></div></div> <p><em>Analysis:</em> mismatch between the self-installed (from source) Eigen (<code class="language-plaintext highlighter-rouge">/usr/local/include/eigen3</code>)and the path pre-defined in ROS packages (<code class="language-plaintext highlighter-rouge">/usr/include/eigen3</code>).</p> <p><em>Solutions:</em></p> <ol> <li>change the correspoinding *.cmake file, change <code class="language-plaintext highlighter-rouge">/usr/include/eigen3;</code> to <code class="language-plaintext highlighter-rouge">/usr/local/include/eigen3</code>. TEDIOUS, lots of files need to be changed.</li> <li>Since eigen3 folder only stores the headers, directly copy <code class="language-plaintext highlighter-rouge">/usr/local/include/eigen3</code> to <code class="language-plaintext highlighter-rouge">/usr/include/eigen3</code>.</li> </ol> <h2 id="pcl">pcl</h2> <blockquote> <p>error: #error PCL requires C++14 or above</p> </blockquote> <p><em>Solution:</em> change C++ standard in cmake file. In <code class="language-plaintext highlighter-rouge">/okvis_ros/CMakeList.txt</code>, add</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>set(CMAKE_CSS_STANDARD 14)
set(CMAKE_CSS_STANDARD_REQUIRED ON)
</code></pre></div></div> <p>right after the project line.</p> <h2 id="dataset_convertorcpp">dataset_convertor.cpp</h2> <p><em>Solution:</em> change all <code class="language-plaintext highlighter-rouge">ofstream</code> to <code class="language-plaintext highlighter-rouge">std::ofstream</code>.</p> <p><a href="https://zhuanlan.zhihu.com/p/101605676" rel="external nofollow noopener" target="_blank">ref_link</a></p> <h2 id="opencv">OpenCV</h2> <h3 id="libgtk-error">libgtk error</h3> <p><em>Full Error Message:</em></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>error: (-2:Unspecified error) the function is not implemented. Rebuild the library with Windows, GTK+2.x or Carbon support. If you are on Unbunto or Debian, install libgtk2.0-dev and pkg-config, then re-runn camke or configuration script in function 'cvNamedWindow'
</code></pre></div></div> <p><em>Analysis:</em> opencv failed to find the libgtk+-2.0 library.</p> <p><em>Solution:</em></p> <ol> <li>Install libgtk with <code class="language-plaintext highlighter-rouge">sudo apt install libgtk2.0-dev</code> </li> <li>Find the path to the libgtk package, Set up <code class="language-plaintext highlighter-rouge">PKG_CONFIG_PATH</code> in <code class="language-plaintext highlighter-rouge">.bashrc</code> file. Add <code class="language-plaintext highlighter-rouge">PKG_CONFIG_PATH=$PKG_CONFIG_PATH:/usr/lib/x86_64-linux-gnu/pkgconfig</code>.</li> <li>Re-build opencv with flag <code class="language-plaintext highlighter-rouge">-D WITH_GTK=ON</code>. e.g. <code class="language-plaintext highlighter-rouge">cmake -D CMAKE_BUILD_TYPE=RELEASE -D OPENCV_EXTRA_MODULES_PATH=../../opencv_contrib-3.4.13/modules -D WITH_CUDA=ON -D WITH_CUDNN=OFF -D BUILD_opencv_cudacodec=OFF -D OPENCV_ENABLE_NONFREE=ON -DBUILD_JAVA=OFF -DBUILD_opencv_java_bindings_generator=OFF -D BUILD_PYTHON=OFF -D BUILD_opencv_python_bindings_generator=OFF -D WITH_QT=ON -D ENABLE_CXX11=ON -D BUILD_TIFF=ON -D WITH_GTK=ON ..</code> </li> </ol> <h2 id="gtstream">gtstream</h2> <blockquote> <p>fatal error: gst/gst.h: no such file or directory</p> </blockquote> <p><em>Analysis:</em> anacodna package conflicts.</p> <p><em>Solution:</em> move anaconda to <code class="language-plaintext highlighter-rouge">Trash</code>, complete installation, and move it back.</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Yuhang Ming. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <div style="height:1px"> <script type="text/javascript" id="clustrmaps" src="//clustrmaps.com/map_v2.js?d=sP5zK6ZHzsC7pQB6E9e6ewkUE27-89S1-RjTxkJHOJM&amp;cl=ffffff&amp;w=400"></script> </div> </body> </html>